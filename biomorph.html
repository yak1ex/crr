<html>
<head>
<link rel="stylesheet" href="crrlib.css" type="text/css" />
<!--<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular.min.js"></script>-->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/mathjs/0.22.0/math.min.js"></script>
<script src="crrlib.js"></script>
<script type="text/javascript">
// TODO: avoid duplication of description and value of fomulae
// TODO: enable to set arbitrary formula
// TODO: reset zoom extent on reconfigure

window.onload = function() {
    var math = mathjs();
    var crr = crrlib();

    var formulae = ['z^3+c', 'z^5+c', 'z^z+z^5+c', 'z^z+z^6+c','sin(z)+z^2+c', 'sin(z)+e^z+c'];
    var formula = math.compile(formulae[0]);
    var c = math.complex(0.5, 0);

    crr.init('#crr-container', {
        cell: function(z) {
            for(var k = 0; k < 10; ++k) {
                z = formula.eval({z: z, c: c });
                if(math.abs(math.re(z)) > 10 || math.abs(math.im(z)) > 10 || math.abs(z) > 10) break;
            }
            return { fill: ((math.abs(math.re(z)) < 10 || math.abs(math.im(z)) < 10) ? '#000000' : '#ffffff') }
        }
    });
    set = function(f) {
        formula = math.compile(f);
        crr.restart();
    };
    crr.run();

}
</script>
</head>
<body>
<div id="crr-container"></div>
<select name="formula" onchange="set(this.value)">
<option value="z^3+c" selected>z^3+c</option>
<option value="z^5+c">z^5+c</option>
<option value="z^z+z^5+c">z^z+z^5+c</option>
<option value="z^z+z^6+c">z^z+z^6+c</option>
<option value="sin(z)+z^2+c">sin(z)+z^2+c</option>
<option value="sin(z)+e^z+c">sin(z)+e^z+c</option>
</select>
</body>
</html>
